import random
import logging
from src.the_spaceship_rental_problem.webserver import Contract
from src.the_spaceship_rental_problem.optimisation_algorithm import sort_contracts, optimize
from src.the_spaceship_rental_problem.models import Contract, Solution

path = "/spaceship/optimize"

def test_sort_same():
    input = [
        Contract(name="Contract1", start=0, duration=5, price=10),
        Contract(name="Contract2", start=3, duration=7, price=14),
        Contract(name="Contract3", start=5, duration=9, price=8),
        Contract(name="Contract4", start=5, duration=9, price=7),
    ]
    output = [
        Contract(name="Contract1", start=0, duration=5, price=10),
        Contract(name="Contract2", start=3, duration=7, price=14),
        Contract(name="Contract3", start=5, duration=9, price=8),
        Contract(name="Contract4", start=5, duration=9, price=7),
    ]
    result = sort_contracts(input)
    assert result == output

def test_sort_simple():
    input = [
        Contract(name="Contract3", start=5, duration=9, price=8),
        Contract(name="Contract1", start=0, duration=5, price=10),
        Contract(name="Contract2", start=3, duration=7, price=14),
        Contract(name="Contract4", start=5, duration=9, price=7),
    ]
    output = [
        Contract(name="Contract1", start=0, duration=5, price=10),
        Contract(name="Contract2", start=3, duration=7, price=14),
        Contract(name="Contract3", start=5, duration=9, price=8),
        Contract(name="Contract4", start=5, duration=9, price=7),
    ]
    result = sort_contracts(input)
    assert result == output


def test_algo_simple():
    input = [
        Contract(name="Contract1", start=0, duration=5, price=10),
        Contract(name="Contract2", start=3, duration=7, price=14),
        Contract(name="Contract3", start=5, duration=9, price=8),
        Contract(name="Contract4", start=5, duration=8, price=7),
        Contract(name="Contract5", start=15, duration=9, price=8),
        Contract(name="Contract6", start=16, duration=8, price=12),
    ]
    output = Solution(income=30, path=["Contract1", "Contract3", "Contract6"])
    solution = optimize(input)
    assert solution == output

def test_algo_simple2():
    input = [
        Contract(name="Contract1", start=0, duration=5, price=10),
        Contract(name="Contract2", start=3, duration=7, price=14),
        Contract(name="Contract3", start=5, duration=9, price=8),
        Contract(name="Contract4", start=5, duration=8, price=7),
        Contract(name="Contract5", start=15, duration=9, price=8),
        Contract(name="Contract6", start=30, duration=8, price=12),
    ]
    output = Solution(income=38, path=["Contract1", "Contract3", "Contract5", "Contract6"])
    solution = optimize(input)
    assert solution == output


def generate_contracts(number: int, seed :int=None):
    random.seed(seed)
    max_start = number * 10
    max_duration = 50
    max_price = 100
    for idx in range(number):
        yield Contract(name=str(idx), start=random.randrange(max_start), duration=random.randrange(1, max_duration + 1), price=random.randrange(1, max_price + 1))

def test_lots():
    contracts = list(generate_contracts(10000, 456))
    output = Solution(income=233066, path=["7022", "7022", "2757", "7840", "6322", "8974", "2440", "6700", "7102", "8656", "7102", "8788",
        "6885", "5297", "1981", "8155", "8875", "7582", "8228", "4784", "4784", "8606", "3108", "7210", "7052", "8433", "7886", "8950", "7626",
        "7843", "1101", "3728", "2982", "6063", "9275", "3632", "3250", "1588", "3104", "3570", "7572", "3161", "8392", "7949", "5855", "3911",
        "4066", "6520", "6410", "6904", "3968", "2443", "2244", "5117", "3740", "2763", "2116", "2763", "1050", "9717", "5200", "9717", "5230",
        "3915", "7230", "2415", "1419", "6358", "3942", "9612", "1476", "2678", "9712", "9245", "925", "6207", "6144", "9515", "5753", "4233",
        "5753", "7158", "967", "231", "3305", "4294", "347", "3337", "6576", "905", "7780", "7604", "1607", "2196", "8195", "7525", "5274", "1596",
        "1596", "5062", "6760", "8090", "4614", "4614", "1458", "4731", "6170", "6229", "9284", "1341", "72", "5444", "327", "4716", "8828", "1656",
        "7552", "3089", "2907", "8475", "6048", "9145", "9145", "3953", "6282", "4811", "1255", "5097", "8611", "663", "5724", "5158", "5362", "4385",
        "9353", "605", "1760", "4149", "3459", "9238", "1176", "7496", "5031", "3304", "1271", "1622", "8852", "759", "1958", "5219", "6649", "8282",
        "3164", "9645", "1296", "1555", "9298", "5225", "6387", "6387", "8579", "2197", "2289", "3857", "2291", "7836", "7883", "8382", "1258", "7610",
        "2869", "1861", "8501", "3214", "8971", "5403", "1790", "1790", "6149", "342", "9339", "2085", "988", "2551", "5266", "7126", "1519", "9058",
        "3177", "7865", "3203", "4406", "8033", "254", "4115", "7438", "9755", "7564", "7799", "5352", "6236", "220", "286", "286", "286", "4997",
        "3092", "2789", "6423", "9265", "8084", "9662", "8933", "9157", "3899", "4498", "2055", "6010", "2201", "4188", "9762", "6617", "3651",
        "1525", "6768", "6386", "7683", "2354", "46", "5970", "3174", "726", "726", "9053", "4559", "1801", "2796", "5697", "746", "892", "5694",
        "9638", "6095", "8849", "8076", "9748", "4453", "9866", "9091", "927", "2040", "7691", "4375", "1211", "7549", "6954", "4124", "260",
        "2905", "2587", "7770", "8152", "4235", "4235", "4713", "4615", "8705", "4546", "5850", "9875", "8342", "4319", "7132", "3660", "3660",
        "1671", "3529", "9009", "7815", "8743", "4536", "7025", "3026", "4676", "8232", "9442", "7963", "8126", "9154", "4052", "1702", "6833",
        "1244", "3926", "4253", "3812", "860", "9723", "2472", "9427", "6177", "4227", "5467", "7351", "2163", "9584", "8253", "8253", "8740",
        "4431", "9214", "7160", "8881", "2735", "2735", "8094", "1999", "4041", "8268", "8268", "4824", "6744", "9830", "9830", "1047", "6782",
        "4598", "4109", "4109", "6456", "4631", "2238", "7862", "2914", "7703", "7703", "5839", "4848", "682", "1445", "9752", "7166", "2988",
        "2809", "7471", "1731", "8797", "3590", "7399", "9844", "3688", "9162", "1626", "1626", "654", "4860", "3813", "1102", "7944", "7281",
        "3320", "3320", "4126", "826", "4715", "6419", "4604", "4635", "2171", "4561", "9514", "7768", "5", "4538", "9410", "1854", "9744", "5510",
        "5628", "1109", "9336", "4588", "1051", "7797", "7037", "2236", "2827", "8286", "1204", "3339", "3758", "6769", "1546", "8339", "8613",
        "8600", "6925", "8928", "2001", "1091", "8640", "6547", "777", "8229", "7675", "4877", "4009", "4334", "1269", "6548", "5495", "366", "9107",
        "8290", "8215", "8839", "5739", "7245", "9881", "6076", "5034", "7159", "4957", "4160", "4957", "5112", "5667", "9807", "8512", "3429", "152",
        "9609", "9609", "7049", "6680", "2069", "7174", "7294", "687", "6093", "8555", "9879", "2451", "2963", "527", "4566", "8733", "8733", "1249",
        "6989", "4978", "2285", "1559", "4956", "5252", "7063", "9094", "5204", "5381", "1450", "9146", "6401", "3971", "9023", "440", "1933", "5918",
        "6881", "6842", "3151", "8338", "1436", "6087", "9255", "8366", "1441", "4279", "5590", "878", "6561", "5329", "6269", "7046", "986", "4338",
        "8894", "6255", "8496", "1048", "4914", "2348", "9478", "3070", "5271", "1457", "6162", "5486", "2562", "1016", "5036", "1997", "5563", "3313",
        "2507", "8266", "5862", "4703", "7860", "5729", "4231", "9453", "9072", "1948", "4057", "3499", "9806", "4975", "995", "74", "6036", "9535",
        "7095", "5666", "8987", "2469", "1888", "7406", "9858", "7226", "8452", "9738", "1609", "4386", "394", "3344", "6837", "9675", "8661", "2497",
        "8910", "9741", "8603", "317", "5155", "9068", "9106", "5550", "2518", "2295", "6037", "1381", "3333", "5514", "1039", "6216", "4700", "2059",
        "7323", "7323", "7891", "807", "9347", "167", "651", "8711", "3463", "8241", "2631", "9859", "1120", "6840", "4325", "7481", "1017", "8420",
        "1029", "2613", "717", "3349", "6464", "7446", "6895", "7717", "7717", "4837", "7386", "7386", "3128", "7030", "3262", "3631", "4056", "9627",
        "5865", "1036", "5744", "8755", "419", "9458", "2762", "4108", "7139", "3498", "6846", "750", "8668", "2938", "3620", "961", "6724", "6247",
        "9221", "7349", "9698", "7428", "6331", "6568", "8383", "5845", "8814", "9526", "8284", "8284", "7684", "1354", "1354", "7186", "5945", "8480",
        "2662", "9211", "8097", "1530", "9789", "587", "2767", "6148", "3266", "6920", "7346", "5551", "9277", "5810", "6117", "4863", "7596", "2209",
        "9225", "9962", "4759", "122", "6514", "5198", "5431", "5431", "6763", "6763", "9344", "2028", "164", "6258", "4159", "73", "8060", "5217",
        "3852", "8738", "7678", "6234", "4080", "8923", "1514", "6254", "8612", "2151", "4455", "6758", "8534", "2421", "7971", "8750", "5794", "7500",
        "3709", "67", "5122", "3074", "9112", "2866", "2204", "8575", "4838", "7624", "5649", "5283", "517", "8273", "5424", "208", "6128", "261",
        "7198", "1373", "1373", "9652", "5610", "7652", "8516", "2051", "9773", "2051", "8340", "6006", "3696", "8100", "265", "9730", "4360", "1123",
        "3013", "1564", "1347", "7148", "1430", "9968", "3919", "1925", "8023", "7872", "4810", "7565", "4045", "8608", "9796", "6641", "6056", "271",
        "7906", "4830", "4830", "7581", "6533", "6390", "5440", "8352", "9600", "2114", "9522", "7246", "6665", "4169", "7172", "9342", "9732", "9732",
        "174", "7672", "7097", "6544", "6028", "1082", "5321", "3539", "3627", "583", "555", "5816", "6480", "5134", "2441", "2378", "2718", "2378",
        "7179", "8132", "9871", "1683", "9724", "5766", "3569", "6975", "9108", "9672", "3533", "7531", "232", "9362", "5728", "9657", "9906", "6596",
        "2545", "4495", "1112", "655", "5944", "720", "1581", "3363", "1947", "9977", "319", "3938", "3735", "4018", "3171", "4414", "6655", "1783",
        "1049", "8064", "2183", "7215", "4311", "5164", "3988", "1241", "6000", "2361", "6291", "7015", "7015", "6909", "8026", "2724", "4158", "3969",
        "3662", "9359", "7661", "1844", "8552", "5684", "9150", "1484", "5858", "8314", "9928", "2814", "636", "2312", "1707", "9220", "6295", "6169",
        "2218", "3144", "4852", "7970", "8871", "6361", "2536", "8543", "1236", "8249", "6814", "7890", "7609", "1914", "2998", "2839", "2245", "7601",
        "9176", "8368", "5422", "7783", "6604", "5804", "7917", "9818", "8082", "245", "245", "3031", "627", "5124", "7464", "9577", "5103", "1960",
        "7237", "9233", "8973", "5932", "9693", "5608", "5012", "9299", "7412", "2225", "9575", "2920", "7029", "7029", "5365", "1906", "8080", "3029",
        "1964", "7193", "59", "4850", "4354", "7712", "6912", "6912", "256", "7469", "2076", "7248", "2824", "1212", "2753", "5426", "9534", "4603",
        "2343", "8034", "2304", "2358", "6455", "4574", "877", "7384", "355", "6884", "5382", "7538", "5149", "9988", "7622", "930", "3930", "802",
        "5709", "1585", "6813", "5448", "2022", "9646", "4478", "4851", "6154", "5089", "8324", "4624", "8540", "9419", "5689", "1207", "7877", "6779",
        "1061", "2427", "7813", "4570", "9328", "5548", "9694", "8396", "4501", "3168", "3046", "7659", "2471", "1100", "5308", "9489", "7145", "5917",
        "5965", "4528", "866", "6452", "4211", "3221", "445", "8059", "2550", "4161", "4161", "1152", "1538", "1562", "2152", "7927", "8731", "630",
        "3416", "2252", "4179", "6492", "6901", "1965", "3885", "8597", "8902", "1306", "3708", "2107", "7253", "2018", "8409", "4480", "9701", "7209",
        "1911", "588", "4647", "8804", "5758", "4310", "787", "470", "3557", "5974", "6887", "1547", "1265", "2922", "6677", "2140", "1606", "7242",
        "2635", "5442", "7897", "250", "8384", "7988", "3036", "4771", "8156", "4799", "8156", "3955", "9206", "887", "6142", "5881", "3135", "4441",
        "4487", "6751", "8031", "9074", "6753", "8530", "2062", "9080", "2935", "5360", "6071", "3378", "6660", "696", "4523", "3068", "5394", "7099",
        "8524", "7614", "1189", "2883", "966", "2883", "3381", "9127", "4326", "5846", "5027", "3449", "5582", "2714", "1768", "2168", "5186", "2885",
        "9509", "6669", "9197", "367", "3402", "6479", "2476", "6041", "7366", "1418", "6499", "26", "7981", "3835", "9280", "7203", "6350", "9947",
        "4044", "6085", "5075", "4650", "7941", "1119", "3118", "5874", "2077", "9075", "9827", "52", "5920", "1160", "175", "1160", "8663", "9770",
        "3217", "1686", "7738", "1058", "334", "3055", "2458", "4605", "3439", "9540", "176", "5599", "3537", "5211", "2501", "5001", "9414", "6616",
        "6616", "2263", "4484", "3396", "4779", "5981", "8841", "4674", "7002", "7478", "8469", "4482", "9381", "958", "1248", "9202", "6276", "3753",
        "8556", "2401", "8879", "5358", "9024", "9731", "8103", "9621", "338", "8285", "4726", "920", "8564", "5735", "258", "4286", "983", "2877",
        "1601", "8999", "4719", "7403", "6796", "1523", "5453", "5139", "1225", "5223", "130", "2387", "3373", "1200", "4949", "7043", "2594", "5014",
        "5290", "928", "5276", "4104", "4086", "4116", "5530", "8721", "4091", "8595", "5343", "4929", "8526", "3350", "8829", "843", "4633", "8625",
        "2888", "4697", "5312", "60", "2528", "5595", "7666", "9070", "3934", "4347", "2764", "3394", "4432", "1462", "1638", "7822", "1831", "8020",
        "5264", "4982", "5439", "37", "1032", "3575", "1075", "2134", "5637", "5063", "6961", "8620", "2983", "765", "1663", "9099", "4899", "7705",
        "8907", "1037", "4200", "5969", "5969", "2893", "706", "1660", "1703", "5387", "9247", "689", "5016", "1684", "7191", "5555", "9184", "9166",
        "5601", "5061", "9868", "1726", "1726", "8104", "8986", "8986", "5388", "456", "2020", "9372", "6798", "431", "8602", "9388", "2840", "1367",
        "872", "8582", "5947", "378", "6355", "3990", "8713", "9446", "1575", "954", "3483", "7311", "8425", "964", "6874", "1828", "4081", "3921",
        "643", "9219", "7440", "5310", "3809", "4803", "7422", "5003", "7293", "4946", "1511", "118", "9594", "5860", "7333", "2758", "9301", "6104",
        "9750", "1181", "5999", "7176", "2153", "7692", "2489", "7896", "2508", "4740", "8984", "1651", "4584", "5288", "5288", "858", "7223", "7397",
        "270", "1752", "3165", "8823", "7373", "3010", "3927", "1394", "5109", "7796", "3451", "6098", "8219", "653", "4625", "3379", "9393", "3356",
        "7033", "3903", "832", "6898", "798", "3078", "1962", "3629", "7654", "9933", "1097", "2363", "4170", "8450", "534", "9927", "2261", "6573",
        "6863", "9089", "4542", "8335", "7585", "8153", "7021", "9536", "2570", "5946", "8760", "6896", "3739", "8271", "2864", "51", "111", "9240",
        "9878", "2852", "6327", "3404", "9631", "5631", "2239", "5699", "3041", "984", "4591", "268", "4377", "6176", "2602", "7701", "7086", "7486",
        "4921", "7965", "3245", "760", "4224", "9313", "3584", "9361", "1365", "139", "4306", "4353", "1351", "5830", "1333", "2130", "8610", "5340",
        "3140", "1894", "98", "895", "4572", "4819", "3202", "5857", "1174", "4540", "3273", "7297", "1409", "6976", "6976", "9529", "817", "1041",
        "4087", "6879", "1487", "3577", "3577", "3577", "3637", "5897", "1361", "4051", "5298", "426", "5233", "7881", "2617", "5239", "2135", "9060",
        "9060", "7945", "9660", "2033", "8553", "7974", "1423", "9109", "9109", "4147", "5521", "973", "2771", "312", "242", "4688", "8901", "684",
        "1346", "9232", "1800", "7785", "7954", "1301", "7262", "3357", "1985", "4243", "1595", "3960", "162", "5571", "7299", "1319", "1227", "7359",
        "8493", "6956", "6497", "3610", "7411", "2431", "5525", "3747", "3747", "502", "3692", "126", "5560", "6242", "9350", "564", "9692", "2818",
        "4218", "3797", "4641", "9294", "3336", "2897", "2516", "2068", "5501", "1891", "7243", "5526", "8699", "6159", "1178", "422", "9100", "9411",
        "1860", "3440", "1242", "7292", "5964", "146", "3484", "4168", "4626", "2614", "2614", "4714", "5151", "8605", "1066", "5307", "4796", "9259",
        "8651", "6849", "5373", "3729", "8349", "1401", "8305", "8578", "7488", "9194", "3411", "9408", "7910", "7818", "39", "7874", "7874", "3935",
        "461", "8071", "7929", "2207", "5470", "2813", "8886", "1616", "1113", "6415", "6838", "2739", "4094", "1336", "9363", "3918", "6906", "3892",
        "7122", "6453", "3456", "5516", "429", "9239", "4467", "9292", "6625", "9338", "6800", "2649", "9523", "8720", "9226", "5987", "1667", "2759",
        "4969", "8309", "2428", "8267", "545", "6821", "3374", "4601", "8233", "8035", "247", "3775", "5815", "1463", "2455", "3040", "7100", "6736",
        "3920", "6245", "1913", "3372", "3682", "3181", "3181", "4344", "2099", "4266", "14", "7493", "2522", "2522", "3900", "7069", "1186", "4649",
        "9165", "7254", "7697", "8604", "8873", "1954", "5197", "7943", "4017", "9132", "2101", "4502", "7272", "1063", "6747", "365", "5187", "7298",
        "9484", "6053", "8756", "3738", "7236", "4024", "6871", "6934", "8441", "9297", "8428", "4758", "5767", "6488", "9955", "8816", "95", "4355",
        "7347", "8919", "3868", "8455", "6378", "9470", "5708", "4808", "1688", "664", "2399", "4196", "4987", "5725", "8040", "4505", "5281", "7592",
        "7340", "8401", "7677", "6622", "1473", "3045", "1739", "369", "4778", "4875", "398", "8802", "4816", "7919", "6640", "5542", "2514", "1866",
        "9437", "946", "5674", "3932", "345", "4291", "5119", "3093", "4933", "9608", "8120", "2576", "4261", "7612", "5114", "2584", "6407", "1798",
        "1262", "9182", "58", "5268", "3664", "8477", "4201", "1315", "9569", "4479", "4829", "3536", "3476", "3623", "96", "1127", "5393", "87", "9829",
        "7749", "6477", "8238", "3283", "7423", "6848", "6391", "5544", "6132", "8632", "1856", "380", "5685", "7777", "195", "6883", "6503", "9147",
        "5328", "2756", "3679", "4448", "5491", "9864", "1721", "6847", "8598", "3939", "3939", "3939", "3119", "1503", "4242", "9869", "282", "6404",
        "3033", "9527", "4672", "4444", "5798", "9046", "809", "2569", "2569", "3023", "2000", "6462", "7175", "8465", "6749", "6738", "6738", "6417",
        "6432", "6438", "5623", "2695", "6974", "1224", "4028", "982", "2712", "8563", "1901", "144", "2534", "6244", "6408", "7138", "9291", "6068",
        "3121", "5569", "6789", "8854", "974", "8122", "3035", "6892", "2681", "2681", "4548", "3490", "2030", "5979", "4419", "7368", "1153", "49",
        "9610", "6951", "705", "1695", "3145", "8380", "1939", "2300", "2716", "3702", "5606", "5068", "2673", "1121", "5579", "8135", "3724", "2448",
        "5841", "4217", "632", "2832", "8130", "8169", "541", "4833", "7562", "4318", "8782", "4107", "4107", "6334", "2977", "2943", "9558", "9511",
        "8688", "8657", "8509", "4669", "2380", "4139", "8836", "3495", "4924", "7431", "8533", "8533", "6502", "4841", "582", "6195", "5123", "8645",
        "7274", "474", "9420", "3458", "3458", "293", "5269", "4481", "6238", "1728", "2560", "6998", "4738", "1899", "6936", "7268", "455", "9426",
        "8178", "361", "7979", "6537", "2211", "2639", "5229", "8566", "4707", "4745", "9222", "1122", "9801", "5943", "1062", "9867", "7301", "9588",
        "8677", "3034", "3667", "1956", "6230", "5401", "3370", "1617", "6917", "6917", "8695", "8321", "2276", "2627", "6866", "3473", "9261", "9619",
        "5993", "4366", "3803", "9980", "2216", "5316", "2956", "8724", "1", "3889", "8234", "1938", "7832", "8759", "8982", "5963", "6443", "6096",
        "3113", "6546", "4627", "6032", "97", "2084", "8541", "4048", "5496", "2911", "2473", "5255", "955", "7119", "6097", "5256", "661", "5713",
        "5977", "4629", "5911", "493", "2770", "4075", "4362", "8356", "7689", "8589", "8438", "6372", "1542", "2512", "3737", "5210", "5577", "490",
        "2669", "3494", "3815", "8500", "4069", "4069", "8030", "9195", "8451", "1256", "1256", "5095", "5547", "4880", "3310", "3043", "3571", "7591",
        "6686", "7508", "2934", "5836", "7251", "2833", "6958", "6844", "3475", "2784", "8629", "5315", "3562", "6461", "4068", "7748", "171", "3649",
        "4694", "4694", "4694", "417", "8908", "4364", "6241", "4301", "1540", "6589", "6835", "1007", "6354", "8024", "5731", "2916", "9196", "4904",
        "6984", "4356", "353", "8453", "5603", "6532", "1371", "5914", "3000", "6581", "6136", "5781", "475", "4732", "7646", "7895", "914", "4973",
        "4510", "1642", "2829", "9951", "3271", "6513", "314", "2704", "8504", "666", "4175", "34", "7302", "1678", "5632", "7878", "6587", "7634",
        "249", "4178", "4490", "439", "2671", "3592", "2270", "6108", "7521", "585", "2600", "1165", "1165", "3700", "7241", "9840", "743", "8853",
        "2592", "5126", "2799", "2799", "1064", "4276", "7501", "3800", "299", "1610", "9998", "9998", "8818", "9883", "1910", "3749", "7512", "3561",
        "2531", "5121", "5220", "2960", "3209", "3874", "6458", "4021", "7509", "4027", "5773", "6012", "1780", "1541", "6437", "1125", "1125", "3897",
        "4241", "8718", "3513", "5535", "5445", "4199", "6011", "9825", "8576", "5332", "9650", "4214", "7483", "1477", "1087", "6061", "4078", "140",
        "1138", "8554", "7133", "1696", "138", "4085", "251", "2393", "6528", "4903", "6021", "9445", "496", "575", "9510", "5478", "7152", "2985",
        "4940", "6739", "6739", "8650", "3573", "5552", "4050", "81", "3289", "7801", "1742", "1742", "2178", "8904", "880", "3410", "9817", "200",
        "2269", "4579", "4423", "6484", "3618", "3618", "4005", "6220", "4991", "498", "6165", "5437", "1452", "9138", "3480", "5871", "1494", "4138",
        "9777", "7192", "324", "4349", "2502", "9054", "472", "646", "7276", "1669", "106", "9200", "4278", "1362", "6856", "3996", "5100", "1239",
        "4871", "3207", "5258", "1836", "7844", "9687", "466", "690", "4801", "4801", "6239", "9896", "9110", "7909", "4896", "7681", "3841", "381",
        "2405", "114", "2317", "4468", "3851", "7410", "6858", "4305", "9496", "1479", "2524", "8678", "1429", "6474", "7165", "9428", "2215", "4402",
        "7267", "9343", "2203", "5838", "281", "6938", "2663", "5967", "5306", "9768", "8211", "3062", "6018", "9828", "8649", "891", "1020", "3826",
        "1488", "8535", "2397", "6911", "8000", "8073", "4203", "1644", "7362", "5133", "4907", "6723", "6992", "387", "2444", "5641", "5641", "48",
        "6765", "9550", "5847", "8648", "9566", "4839", "5889", "8561", "8041", "8067", "4032", "2127", "2487", "5771", "2287", "7707", "5023", "7721",
        "5293", "5723", "9728", "8440", "1103", "9", "3731", "7648", "657", "1059", "7852", "7599", "8715", "1772", "9603", "9937", "9464", "1003",
        "2463", "1235", "6947", "5344", "9209", "8006", "8423", "433", "8815", "1403", "9686", "1782", "1782", "7367", "2917", "547", "4683", "3817",
        "1966", "9629", "5618", "9884", "4636", "2104", "5113", "4395", "3107", "3880", "6983", "6804", "4342", "7536", "7536", "7536", "3051", "1480",
        "1900", "1145", "308", "308", "9492", "3080", "3414", "244", "7280", "9618", "6121", "9436", "2160", "6832", "9776", "9357", "784", "2102",
        "210", "1890", "1233", "3576", "631", "5575", "5004", "53", "5833", "5711", "4181", "1350", "7291", "8946", "8432", "2221", "5714", "7716",
        "3961", "5371", "5371", "673", "110", "5812", "2339", "158", "1650", "5057", "8280", "2013", "9799", "1298", "1298", "1052", "782", "8299",
        "9481", "5078", "9039", "776", "5877", "855", "4872", "1788", "8255", "2195", "1996", "7044", "5791", "3276", "7704", "933", "2198", "1849",
        "8394", "5086", "2991", "7702", "864", "3169", "6829", "7005", "3878", "3878", "7858", "9587", "9300", "5029", "11", "326", "4274", "6634",
        "9882", "1604", "594", "8671", "7173", "8240", "4916", "821", "9913", "9592", "758", "8123", "1765", "609", "7952", "8052", "8542", "2449",
        "7539", "7984", "1508", "8915", "1897", "8056", "396", "8489", "264", "4849", "5267", "6595", "7136", "7170", "5179", "2855", "1360", "539",
        "1681", "7990", "5645", "2164", "7442", "2106", "5504", "4967", "6795", "6650", "1086", "1208", "1599", "5532", "9472", "4223", "8757", "6893",
        "7419", "702", "702", "9624", "6661", "9624", "2241", "1000", "8448", "1741", "2321", "4652", "4652", "626", "7905", "188", "602", "3732",
        "9317", "8572", "7495", "2326", "1689", "8998", "5007", "3441", "3176", "1777", "1635", "9975", "2039", "5770", "5770", "132", "4834", "4513",
        "4859", "1809", "1809", "1444", "4415", "7590", "2599", "8985", "5780", "4237", "9289", "3474", "5116", "7430", "6003", "8303", "1840", "7068",
        "9564", "4363", "6978", "5163", "339", "9682", "783", "1775", "9555", "2138", "1218", "6110", "4173", "7485", "6611", "4255", "5399", "6113",
        "6810", "2946", "5156", "6298", "6685", "179", "7567", "9051", "8487", "9821", "9700", "8551", "738", "9979", "7146", "9179", "9179", "1955",
        "3893", "3489", "8022", "7353", "1697", "4015", "7261", "3779", "309", "3962", "692", "9367", "5951", "2760", "344", "9371", "8186", "7389",
        "2026", "1747", "4307", "7356", "7365", "7456", "4708", "5180", "4998", "9853", "8244", "4429", "8508", "1534", "1534", "1753", "4396", "840",
        "1424", "2098", "6757", "3225", "5738", "521", "2492", "2156", "8803", "2156", "5581", "3902", "8807", "2609", "6233", "3625", "5720", "5955",
        "5806", "2184", "5477", "3780", "7059", "2999", "4212", "1395", "8260", "6529", "4943", "8044", "7169", "3191", "3160", "3905", "6562", "9316",
        "9804", "8596", "1187", "1106", "8054", "9013", "5803", "1130", "4858", "8968", "8753", "5818", "8753", "6388", "6388", "8221", "4058", "617",
        "2547", "3612", "3958", "3292", "9986", "7452", "4457", "7548", "4037", "9327", "7213", "6864", "970", "970", "9772", "8345", "598", "358",
        "358", "3150", "9783", "2967", "2873", "2606", "2674", "1474", "4197", "4925", "6924", "6888", "5681", "3101", "2703", "4699", "2703", "5111",
        "2481", "3716", "3215", "2495", "7183", "3984", "2667", "1654", "5994", "5391", "3616", "4693", "259", "2121", "2459", "2459", "3063", "3807",
        "4597", "9391", "5782", "3963", "2971", "153", "7490", "8190", "91", "2369", "4995", "9753", "4701", "2429", "3311", "5807", "1579", "3186",
        "6300", "4285", "9312", "2337", "9156", "1769", "9647", "786", "7335", "4842", "2633", "4321", "5784", "694", "1865", "3808", "4795", "5538",
        "5538", "9634", "2794", "6070", "7290", "1693", "2331", "3855", "3246", "7713", "2865", "7164", "4130", "7794", "8245", "7144", "9050", "9524",
        "5541", "8129", "7725", "6293", "25", "3763", "9389", "1179", "3867", "2419", "6619", "6619", "7460", "9293", "3052", "947", "5147", "4296",
        "2820", "3549", "9598", "497", "1884", "3467", "7899", "2373", "6013", "178", "9893", "708", "3365", "7364", "4140", "9842", "279", "3736",
        "4123", "9173", "2800", "5923", "8191", "6823", "4750", "2684", "9270", "6706", "6754", "9320", "4534", "7445", "5218", "7094", "9952", "4065",
        "1177", "5727", "8357", "1309", "6440", "7320", "6326", "7714", "5793", "5640", "8390", "3299", "6321", "8331", "5320", "4403", "4403", "5327",
        "4209", "4555", "5742", "5244", "3655", "7767", "2169", "5175", "8032", "1279", "7127", "4675", "2303", "5262", "3917", "6602", "3069", "5066",
        "1437", "9151", "6178", "4445", "1018", "3097", "383", "5591", "2242", "2242", "616", "1461", "3972", "3972", "6569", "3555", "8161", "3445",
        "3547", "1804", "7849", "6185", "3419", "2288", "288", "1008", "5465", "7407", "7407", "2908", "3102", "7912", "3957", "5574", "6444", "1400",
        "6567", "1284", "5942", "3987", "1837", "7484", "3890", "9626", "9626", "9124", "6394", "8414", "4712", "8633", "7782", "9790", "9823", "1532",
        "949", "1368", "9055", "563", "6067", "9199", "9216", "3956", "3647", "8212", "8498", "6997", "6106", "6106", "1551", "819", "8036", "9071",
        "8939", "1267", "3967", "540", "578", "6352", "1015", "601", "2719", "997", "908", "8497", "3319", "6780", "2506", "38", "3485", "6332", "5762",
        "6507", "1240", "1175", "9494", "6279", "4156", "8660", "218", "2817", "4868", "1223", "1223", "518", "963", "5834", "3111", "9498", "2902",
        "1129", "2847", "8363", "3358", "7734", "6222", "1658", "6465", "6020", "3335", "3622", "6424", "7615", "9981", "6539", "428", "1105", "5736",
        "1942", "2913", "2774", "1778", "2262", "1173", "6699", "7008", "9739", "737", "5025", "5506", "5500", "3507", "9950", "9950", "7265", "5703",
        "5703", "2482", "5691", "9346", "3332", "2511", "3563", "3563", "4590", "2057", "9785", "9785", "7709", "6414", "3345", "6890", "6530", "6475",
        "9076", "9613", "9613", "2859", "1976", "3406", "7573", "9241", "3653", "3002", "5672", "5672", "4962", "4962", "7699", "7045", "4634", "6764",
        "934", "4117", "5580", "9586", "5765", "2292", "2580", "2189", "2858", "4128", "8580", "667", "1303", "6030", "5745", "500", "204", "6683",
        "9288", "9223", "9223", "3249", "4512", "6026", "3433", "6826", "9315", "362", "9444", "1603", "4564", "7307", "9485", "3285", "9417", "5386",
        "2442", "1343", "2125", "8011", "4934", "7911", "7337", "1033", "6614", "7711", "7559", "1110", "6715", "981", "301", "9047", "6109", "8218",
        "4678", "889", "8277", "8277", "1098", "6473", "8270", "3519", "2499", "3075", "4673", "8990", "8283", "7255", "7249", "4761", "9002", "8845",
        "5956", "2538", "1568", "1568", "4822", "2385", "8862", "7078", "5785", "4644", "4847", "4544", "8800", "8204", "1069", "4339", "9181", "3492",
        "5492", "1531", "3012", "813", "10", "2640", "2640", "1247", "4531", "3585", "1625", "7361", "8991", "5978", "8679", "3824", "277", "6785",
        "8472", "1857", "7790", "193", "7106", "491", "5774", "5215", "3727", "4993", "4083", "9341", "9020", "9904", "9956", "2700", "9537", "1088",
        "3856", "5558", "6566", "2349", "5342", "4177", "3755", "7065", "8994", "7024", "999", "36", "2456", "7520", "8878", "7542", "23", "9403",
        "3725", "7629", "3725", "4144", "8354", "7758", "1415", "5852", "9508", "1055", "2206", "3392", "1843", "7285", "2332", "5045", "1988", "871",
        "871", "6312", "7124", "8869", "9559", "6541", "6280", "7997", "3117", "8093", "915", "3184", "2765", "4016", "7710", "321", "8952", "7535",
        "613", "3818", "5716", "8654", "6900", "8954", "88", "1756", "8594", "7809", "7569", "5479", "7969", "8993", "8888", "7754", "43", "1872",
        "2117", "3983", "2693", "6073", "9691", "1825", "4131", "522", "8584", "1907", "6296", "2969", "9715", "1936", "762", "145", "6965", "6820",
        "432", "432", "207", "9140", "4330", "861", "7558", "923", "7315", "7014", "1665", "3608", "6996", "5378", "8405", "7374", "6107", "6107",
        "9808", "2003", "4434", "2702", "5527", "2537", "1649", "5056", "6014", "5236", "2696", "7888", "3260", "9978", "790", "3936", "1460", "4345",
        "4918", "7201", "611", "3170", "2849", "7286", "4185", "1820", "5483", "5483", "2699", "2699", "9186", "3508", "4889", "4889", "450", "7125",
        "2079", "1983", "7420", "4250", "8675", "7686", "6240", "5808", "9011", "7504", "2685", "6662", "6316", "1864", "3129", "5528", "2181", "2958",
        "3865", "2932", "3298", "9685", "2945", "1987", "3478", "3248", "2119", "3862", "5675", "2334", "3486", "7529", "741", "4400", "3259", "659",
        "4105", "2217", "3163", "2708", "5490", "8444", "7967", "1883", "5169", "4554", "9815", "2552", "7336", "6262", "481", "9079", "5317", "4025",
        "8892", "3201", "3848", "1001", "3686", "3686", "2706", "9676", "1180", "6272", "1072", "7730", "5372"])
    solution = optimize(contracts)
    assert solution == output
